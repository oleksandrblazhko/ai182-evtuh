|№ загрози |MTMT-рекомендації з усунення загроз|
|---|:-----------------------------------:|
|0|Ensure that authenticated ASP.NET pages incorporate UI Redressing or clickjacking defences. Refer: https://aka.ms/tmtconfigmgmt#ui-defenses  Ensure that only trusted origins are allowed if CORS is enabled on ASP.NET Web Applications. Refer: https://aka.ms/tmtconfigmgmt#cors-aspnet  Mitigate against Cross-Site Request Forgery (CSRF) attacks on ASP.NET web pages. Refer: https://aka.ms/tmtsmgmt#csrf-asp
|1|Ensure that administrative interfaces are appropriately locked down. Refer: https://aka.ms/tmtauthn#admin-interface-lockdown  Enforce sequential step order when processing business logic flows. Refer: https://aka.ms/tmtauthz#sequential-logic  Ensure that proper authorization is in place and principle of least privileges is followed. Refer: https://aka.ms/tmtauthz#principle-least-privilege  Business logic and resource access authorization decisions should not be based on incoming request parameters. Refer: https://aka.ms/tmtauthz#logic-request-parameters  Ensure that content and resources are not enumerable or accessible via forceful browsing. Refer: https://aka.ms/tmtauthz#enumerable-browsing
|2|Do not expose security details in error messages. Refer: https://aka.ms/tmtxmgmt#messages Implement Default error handling page. Refer: https://aka.ms/tmtxmgmt#default  Set Deployment Method to Retail in IIS. Refer: https://aka.ms/tmtxmgmt#deployment  Use only approved symmetric block ciphers and key lengths. Refer: https://aka.ms/tmtcrypto#cipher-length  Use approved block cipher modes and initialization vectors for symmetric ciphers. Refer: https://aka.ms/tmtcrypto#vector-ciphers  Use approved asymmetric algorithms, key lengths, and padding. Refer: https://aka.ms/tmtcrypto#padding  Use approved random number generators. Refer: https://aka.ms/tmtcrypto#numgen  Do not use symmetric stream ciphers. Refer: https://aka.ms/tmtcrypto#stream-ciphers  Use approved MAC/HMAC/keyed hash algorithms. Refer: https://aka.ms/tmtcrypto#mac-hash  Use only approved cryptographic hash functions. Refer: https://aka.ms/tmtcrypto#hash-functions  Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. Refer: https://aka.ms/tmtcommsec#x509-ssltls
|3|Ensure that the application does not log sensitive user data. Refer: https://aka.ms/tmtauditlog#log-sensitive-data  Ensure that Audit and Log Files have Restricted Access. Refer: https://aka.ms/tmtauditlog#log-restricted-access
|4|Ensure that the application does not log sensitive user data. Refer: https://aka.ms/tmtauditlog#log-sensitive-data  Ensure that Audit and Log Files have Restricted Access. Refer: https://aka.ms/tmtauditlog#log-restricted-access
|5|Ensure that auditing and logging is enforced on the application. Refer: https://aka.ms/tmtauditlog#auditing  Ensure that log rotation and separation are in place. Refer: https://aka.ms/tmtauditlog#log-rotation  Ensure that Audit and Log Files have Restricted Access. Refer: https://aka.ms/tmtauditlog#log-restricted-access  Ensure that User Management Events are Logged. Refer: https://aka.ms/tmtauditlog#user-management
|6|Set up session for inactivity lifetime. Refer: https://aka.ms/tmtsmgmt#inactivity-lifetime  Implement proper logout from the application. Refer: https://aka.ms/tmtsmgmt#proper-app-logout
|7|Enable ValidateRequest attribute on ASP.NET Pages. Refer: https://aka.ms/tmtconfigmgmt#validate-aspnet  Encode untrusted web output prior to rendering. Refer: https://aka.ms/tmtinputval#rendering  Avoid using Html.Raw in Razor views. Refer: https://aka.ms/tmtinputval#html-razor  Sanitization should be applied on form fields that accept all characters e.g, rich text editor . Refer: https://aka.ms/tmtinputval#richtext  Do not assign DOM elements to sinks that do not have inbuilt encoding . Refer: https://aka.ms/tmtinputval#inbuilt-encode
|8|Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. Refer: https://aka.ms/tmtcommsec#x509-ssltls
|9|Implement Content Security Policy (CSP), and disable inline javascript. Refer: https://aka.ms/tmtconfigmgmt#csp-js  Enable browser's XSS filter. Refer: https://aka.ms/tmtconfigmgmt#xss-filter  Access third party javascripts from trusted sources only. Refer: https://aka.ms/tmtconfigmgmt#js-trusted  Enable ValidateRequest attribute on ASP.NET Pages. Refer: https://aka.ms/tmtconfigmgmt#validate-aspnet  Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing . Refer: https://aka.ms/tmtinputval#out-sniffing  Use locally-hosted latest versions of JavaScript libraries . Refer: https://aka.ms/tmtconfigmgmt#local-js  Ensure appropriate controls are in place when accepting files from users. Refer: https://aka.ms/tmtinputval#controls-users  Disable automatic MIME sniffing. Refer: https://aka.ms/tmtconfigmgmt#mime-sniff  Encode untrusted web output prior to rendering. Refer: https://aka.ms/tmtinputval#rendering  Perform input validation and filtering on all string type Model properties. Refer: https://aka.ms/tmtinputval#typemodel  Ensure that the system has inbuilt defences against misuse. Refer: https://aka.ms/tmtauditlog#inbuilt-defenses  Enable HTTP Strict Transport Security (HSTS). Refer: https://aka.ms/tmtcommsec#http-hsts  Implement input validation on all string type parameters accepted by Controller methods. Refer: https://aka.ms/tmtinputval#string-method  Avoid using Html.Raw in Razor views. Refer: https://aka.ms/tmtinputval#html-razor  Sanitization should be applied on form fields that accept all characters e.g, rich text editor . Refer: https://aka.ms/tmtinputval#richtext  Do not assign DOM elements to sinks that do not have inbuilt encoding . Refer: https://aka.ms/tmtinputval#inbuilt-encode
|10|Ensure that type-safe parameters are used in Web Application for data access. Refer: https://aka.ms/tmtinputval#typesafe
|11|Do not expose security details in error messages. Refer: https://aka.ms/tmtxmgmt#messages Implement Default error handling page. Refer: https://aka.ms/tmtxmgmt#default  Set Deployment Method to Retail in IIS. Refer: https://aka.ms/tmtxmgmt#deployment  Use only approved symmetric block ciphers and key lengths. Refer: https://aka.ms/tmtcrypto#cipher-length  Use approved block cipher modes and initialization vectors for symmetric ciphers. Refer: https://aka.ms/tmtcrypto#vector-ciphers  Use approved asymmetric algorithms, key lengths, and padding. Refer: https://aka.ms/tmtcrypto#padding  Use approved random number generators. Refer: https://aka.ms/tmtcrypto#numgen  Do not use symmetric stream ciphers. Refer: https://aka.ms/tmtcrypto#stream-ciphers  Use approved MAC/HMAC/keyed hash algorithms. Refer: https://aka.ms/tmtcrypto#mac-hash  Use only approved cryptographic hash functions. Refer: https://aka.ms/tmtcrypto#hash-functions  Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. Refer: https://aka.ms/tmtcommsec#x509-ssltls
|12|Ensure that the application does not log sensitive user data. Refer: https://aka.ms/tmtauditlog#log-sensitive-data  Ensure that Audit and Log Files have Restricted Access. Refer: https://aka.ms/tmtauditlog#log-restricted-access
|13|Ensure that auditing and logging is enforced on the application. Refer: https://aka.ms/tmtauditlog#auditing  Ensure that log rotation and separation are in place. Refer: https://aka.ms/tmtauditlog#log-rotation  Ensure that Audit and Log Files have Restricted Access. Refer: https://aka.ms/tmtauditlog#log-restricted-access  Ensure that User Management Events are Logged. Refer: https://aka.ms/tmtauditlog#user-management
|14|Verify X.509 certificates used to authenticate SSL, TLS, and DTLS connections. Refer: https://aka.ms/tmtcommsec#x509-ssltls
|15|Explicitly disable the autocomplete HTML attribute in sensitive forms and inputs. Refer: https://aka.ms/tmtdata#autocomplete-input  Perform input validation and filtering on all string type Model properties. Refer: https://aka.ms/tmtinputval#typemodel  Validate all redirects within the application are closed or done safely. Refer: https://aka.ms/tmtinputval#redirect-safe  Enable step up or adaptive authentication. Refer: https://aka.ms/tmtauthn#step-up-adaptive-authn  Implement forgot password functionalities securely. Refer: https://aka.ms/tmtauthn#forgot-pword-fxn  Ensure that password and account policy are implemented. Refer: https://aka.ms/tmtauthn#pword-account-policy  Implement input validation on all string type parameters accepted by Controller methods. Refer: https://aka.ms/tmtinputval#string-method
|16|Ensure that type-safe parameters are used in Web Application for data access. Refer: https://aka.ms/tmtinputval#typesafe
|17|Encrypt sections of Web App's configuration files that contain sensitive data. Refer: https://aka.ms/tmtdata#encrypt-data
|18|When possible use Azure Active Directory Authentication for connecting to SQL Database. Refer: https://aka.ms/tmt-th10a Ensure that least-privileged accounts are used to connect to Database server. Refer: https://aka.ms/tmt-th10b and https://aka.ms/tmt-th10c
|19|Restrict access to Azure SQL Database instances by configuring server-level and database-level firewall rules to permit connections from selected networks (e.g. a virtual network or a custom set of IP addresses) where possible. Refer:https://aka.ms/tmt-th143
|20|Clients connecting to an Azure SQL Database instance using a connection string should ensure encrypt=true and trustservercertificate=false are set. This configuration ensures that connections are encrypted only if there is a verifiable server certificate (otherwise the connection attempt fails). This helps protect against Man-In-The-Middle attacks. Refer: https://aka.ms/tmt-th144
|21|Enable Transparent Data Encryption (TDE) on Azure SQL Database instances to have data encrypted at rest. Refer:https://aka.ms/tmt-th145a. Use the Always Encrypted feature to allow client applications to encrypt sensitive data before it is sent to the Azure SQL Database. Refer: https://aka.ms/tmt-th145b 
|22|Enable auditing on Azure SQL Database instances to track and log database events. After configuring and customizing the audited events, enable threat detection to receive alerts on anomalous database activities indicating potential security threats. Refer: https://aka.ms/tmt-th147
|23|It is recommended to rotate user account passwords (e.g. those used in connection strings) regularly, in accordance with your organization's policies. Store secrets in a secret storage solution (e.g. Azure Key Vault).
